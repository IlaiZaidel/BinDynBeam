<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Audio Demos – Binaural Deep Beamforming</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px auto; max-width: 900px; line-height: 1.6; }
    h1, h2 { text-align: center; color: #003366; }
    h2 { margin-top: 40px; border-bottom: 1px solid #ccc; padding-bottom: 4px; }
    audio { width: 100%; margin: 4px 0 12px 0; }
    img { width: 100%; border: 1px solid #ccc; margin-top: 8px; }
    section { margin-bottom: 60px; }
    footer { text-align: center; font-size: 0.9em; color: #666; margin-top: 40px; }

    /* ---- New: analysis layout helpers ---- */
    .analysis-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 18px;
      margin-top: 18px;
    }
    @media (min-width: 900px) {
      .analysis-grid { grid-template-columns: 1fr 1fr; }
    }
    .card {
      border: 1px solid #d9d9d9;
      border-radius: 10px;
      padding: 14px;
      background: #fafafa;
    }
    .card h3 {
      margin: 0 0 8px 0;
      color: #003366;
      font-size: 1.05em;
    }
    .small-note {
      font-size: 0.95em;
      color: #444;
      margin: 10px auto 0 auto;
      max-width: 850px;
      text-align: justify;
    }
    .caption {
      font-size: 0.92em;
      color: #555;
      margin-top: 6px;
    }
    .pill {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 999px;
      border: 1px solid #cfcfcf;
      background: #ffffff;
      font-size: 0.9em;
      margin-bottom: 8px;
      color: #003366;
    }
  </style>
</head>
<body>

  <h1>Audio Samples – Binaural Deep Dynamic Beamforming</h1>
  <p style="text-align:center">
    Ilai Zaidel and Sharon Gannot  
    <br>
    Audio samples accompanying the paper:<br>
    <i>"A Study of Binaural Deep Beamforming with Interpretable Beampatterns Guided by Time-Varying RTF"</i>
  </p>

  <p class="small-note">
      In this work, we propose a deep beamforming framework for speech enhancement in dynamic acoustic environments.
      The framework learns time-varying beamformer weights from noisy multichannel signals via a deep neural network,
      guided by a continuously tracked relative transfer function (RTF) of a moving target speaker. We analyze the
      network’s spatial behavior on an 8-microphone linear array by evaluating narrowband and wideband beampatterns
      in three modes: (i) oracle guidance with true RTFs, (ii) guidance with subspace-tracked RTF estimates, and
      (iii) operation without RTF guidance. Results show that RTF guidance yields smoother, more spatially consistent
      beampatterns that track the target DOA, whereas the unguided model fails to maintain a clear spatial focus.
      We further extend the framework to binaural beamforming for a dynamic target speaker, trained using a
      head-related transfer function (HRTF)-based acoustic simulation of a moving speaker. Spatial-cue preservation
      is evaluated via interaural level and time differences (ILD/ITD), demonstrating suitability for hearable
      applications.
  </p>

  <!-- ================= BINAURAL / SPATIAL ANALYSIS ================= -->
  <section id="binaural-analysis">
    <h2>Binaural analysis – spatial behavior and cue preservation</h2>

    <p class="small-note">

    </p>

    <div class="analysis-grid">

      <!-- Mixture -->
      <div class="card">
        <div class="pill">Reference</div>
        <h3>Mixture (binaural)</h3>
        <!-- Only _0.wav -->
        <audio controls src="audio/binaural/10_2_Final_TRUE_RTF_y_0.wav"></audio>
        <img src="audio/binaural/clean_y_spectrogram.png" alt="Mixture/Reference spectrogram">
        <div class="caption">Spectrogram: reference/mixture (as saved in your folder).</div>
      </div>

      <!-- Oracle / True RTF -->
      <div class="card">
        <div class="pill">Mode (i)</div>
        <h3>Oracle guidance (True RTF)</h3>
        <!-- Only _0.wav -->
        <audio controls src="audio/binaural/10_2_Final_TRUE_RTF__x_hat_stage1_0.wav"></audio>
        <img src="audio/binaural/true_rtf_spectrogram.png" alt="True-RTF guided spectrogram">
        <div class="caption">RTF-guided enhancement using true/oracle RTFs.</div>
      </div>

      <!-- Subspace tracked / PAST -->
      <div class="card">
        <div class="pill">Mode (ii)</div>
        <h3>Guidance with tracked RTF (PAST)</h3>
        <!-- Only _0.wav -->
        <audio controls src="audio/binaural/12_2_RTF_TRACKING_PAST__x_hat_stage1_0.wav"></audio>
        <img src="audio/binaural/past_rtf_spectrogram.png" alt="PAST-RTF guided spectrogram">
        <div class="caption">RTF-guided enhancement using subspace-tracked (PAST) RTF estimates.</div>
      </div>

      <!-- No RTF guidance -->
      <div class="card">
        <div class="pill">Mode (iii)</div>
        <h3>No RTF guidance</h3>
        <!-- Only _0.wav -->
        <audio controls src="audio/binaural/10_2_Final_MIX_ONLY_DEVICE_1__x_hat_stage1_0.wav"></audio>
        <img src="audio/binaural/no_rtf_spectrogram.png" alt="No-RTF spectrogram">
        <div class="caption">Unguided model: reduced directionality / less consistent spatial focus.</div>
      </div>

    </div>


  <section>
    <h2>Example 1 – Babble Noise (3 dB SNR)</h2>

    <b>Mixture (Stereo)</b><br>
    <audio controls src="audio/mixture/Dynamic_Speaker_3_SNR_Mixture.wav"></audio>
    <img src="audio/spectograms/mixture_6_spectrogram.png" alt="Mixture spectrogram (3 dB)">

    <b>Enhanced (Stereo)</b><br>
    <audio controls src="audio/enhanced/Dynamic_Speaker_3_SNR_Enhanced.wav"></audio>
    <img src="audio/spectograms/estimated_6_spectrogram.png" alt="Estimated spectrogram (3 dB)">

    <b>Clean Reference (Stereo)</b><br>
    <audio controls src="audio/clean/Dynamic_Clean_Speech.wav"></audio>
    <img src="audio/spectograms/clean_6_spectrogram.png" alt="Clean spectrogram (3 dB)">
  </section>
  <section id="multichannel">
    <h2>Multichannel beamforming for speech enhancement with dynamic target speaker </h2>
  <section>
    <h2>Example 2 – Babble Noise (6 dB SNR)</h2>

    <b>Mixture (Stereo)</b><br>
    <audio controls src="audio/mixture/Dynamic_Speaker_6_SNR_Mixture.wav"></audio>
    <img src="audio/spectograms/mixture_4_spectrogram.png" alt="Mixture spectrogram (6 dB)">

    <b>Enhanced (Stereo)</b><br>
    <audio controls src="audio/enhanced/Dynamic_Speaker_6_SNR_Enhanced.wav"></audio>
    <img src="audio/spectograms/estimated_4_spectrogram.png" alt="Estimated spectrogram (6 dB)">

    <b>Clean Reference (Stereo)</b><br>
    <audio controls src="audio/clean/Dynamic_Clean_Speech_2.wav"></audio>
    <img src="audio/spectograms/clean_4_spectrogram.png" alt="Clean spectrogram (6 dB)">
  </section>

  <footer>
    © 2025 Ilai Zaidel · Sharon Gannot · Bar-Ilan University Speech Processing Lab
  </footer>

</body>
</html>
